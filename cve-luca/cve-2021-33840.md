# CVE-2021-33840

## Description (CNA suggestion)

The server in Luca through 1.1.14 allows remote attackers to cause a
denial of service (insertion of many fake records related to COVID-19)
because Phone Number data lacks a digital signature.

## Additional Information

The "Luca" System assures verified phone numbers for user participating
in the system, in order to provide authorized health departments a
possibility to contact users which were involved in a Covid-19
infection-chain. No other user provided contact data gets verified, so
it is crucial for the integrity of the system, that the verification
process for the phone number is working.

There are two relevant steps in the registration workflow:

- **Step 1**: The Luca-Client (f.e. Android App) transmits the user's phone
  number to the Luca-backend, which then issues a 3rd party service to
  send a verification SMS to the provided phone number. Once the user
  enters the TAN a second request is made to the backend. The response to
  the second request indicates if the submitted TAN was correct.
- **Step 2**: Once step 1 was completed, the client continues to send the
  encrypted form of the user's contact data to the backend and receives
  an assigned "user ID" in response, indicating that the user was
  registered.

With regards to the two steps described above, the backend server
behaves stateless, which means the Luca-client decides if it moves on
to step 2 or not, based on the result of step 1. As the client is
controlled by the user, the first step could be skipped easily,
ultimately bypassing the whole verification process.

This allows to create an unlimited amount of invalid user accounts and
trigger check-ins of those accounts to various locations. Ultimately
authorized health-departments are posed to the risk of getting flooded
with invalid data, during attempts to trace infections (every infection
contact has to be verified manually).

The issue is publicly known since the release of the system, but was
not addressed by the vendor, so far.

A possible mitigation was discussed in the gitlab repo of the vendor,
but not deployed (see gitlab reference)

## VulnerabilityType Other

CWE-345: Insufficient Verification of Data Authenticity

## Vendor of Product

culture4life GmbH

## Affected Product Code Base

"Luca" - Covid-19 contact tracing system

- version 1.1.14 and prior versions on Web Backend

## Affected Component

Backend, Health department frontend

## Attack Type

Remote

## CVE Impact Other

Improper verification of phone numbers allows to create invalid accounts, which could be checked-in to Luca-location in order to increase workload on authorized health departments when tracing COVID-19 contacts

## Attack Vectors

Bypass of SMS-TAN based phone number verification during user registration process

## Reference

1. https://luca-app.de/securityoverview/processes/guest_registration.html#verifying-the-contact-data
2. https://gitlab.com/lucaapp/web/-/issues/1#note_560963608
