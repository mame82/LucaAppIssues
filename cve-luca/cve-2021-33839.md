# CVE-2021-33839

## Description (CNA suggestion)

Luca through 1.7.4 on Android allows remote attackers to obtain sensitive information
about COVID-19 tracking because the QR code of a Public Location can be intentionally
confused with the QR code of a Private Meeting.

## Additional Information

By manipulating QRCodes, locations owners are able to obtain
unauthorized access to PII (first name, last name) of location guests,
which should only be available to authorized health departments.

The "luca" system distinguishes two types of locations:

- **Type 1**: "Private Meetings" owned by a private person: Guests are able
  to check-in to a private meeting by scanning the QRCode, which is
  displayed by the app of the meeting owner. With the check-in the guest
  automatically provides her first and last name, encrypted with the
  public key of the "meeting owner". Ultimately, the meeting owner is
  able to decrypt and display those PII on the device running the Luca
  App. Neither the check-in data, nor the Guest's name are made available
  to external entities (including health departments). The Guest's app
  displays an information dialog, stating that "your host can see your
  first and last name".

- **Type 2**: "Public locations" owned by registered "venue owners": Guests
  are able to check-in to a location by scanning the QRCode, which was
  generated by the Luca system and printed on paper by the registered
  venue Owner. In contrast to private meetings, no additional data should
  be provided to the location owner. Instead, an "encrypted contact data
  reference" gets transmitted to the "Luca" backend after the check-in,
  which gets encrypted with the public key of health departments
  (authorized for data access) and gets encrypted a second time with key
  material of the venue owner. A venue owner shall not able to learn any
  user data, which is assured because venue owners have no access to the
  private keys of health departments (inner encryption).

A venue owner is able to make the QRCode of a "public location" (Type 1)
appear to be a QRCode for a "private meeting" (Type 2). If a guest
scans the QRCode with the Luca App the aforementioned information
dialog for private meetings is shown, but chances are high, that the
guest skips the dialog, as it makes no sense in the context of a
physical location the guest wants to enter (to check-in to the location,
a dialog confirmation is necessary). The "Luca" app applies no further
checks, to determine if the target location is indeed a private meeting
and ultimately sends the Guest's first and last name to the backend.
The resulting data is only encrypted with the public key of the location
(encryption for authorized health department is not applied anymore).
Although the backend server is aware of the fact, that the check-in
location is **not** a private meeting, the provided PII gets stored on the
server and could from now on be accessed by the location owner (first and
last name of guests, check-in and check-out timestamp).

This behavior violates the following vendor defined security objectives
(reference):

- O1: An Uninfected Guest's Contact Data is known only to
  their Guest App
- O2: An Uninfected Guest's Check-Ins cannot be
  associated to the Guest

The issue was published in a demo video (Youtube, German, see
reference). The vendor showed no intention to fix the issue, but made
false claims on the root cause when the demo was also made available on
Twitter (reference, Twitter statement of culture4live CEO).

## VulnerabilityType Other

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

## Vendor of Product

culture4life GmbH

## Affected Product Code Base

"Luca" - Covid-19 contact tracing System

- version 1.7.4 and prior versions on Android
- version 1.1.14 and prior versions on Web Backend

## Affected Component

Backend, Android Client

## Attack Type

Context-dependent

## Impact Information Disclosure

true

## Attack Vectors

Location owner manipulates check-in QR-Code, which is scanned by Guests, in order to learn otherwise protected PII of the guest

## Reference

1. https://youtu.be/jWyDfEB0m08
2. https://luca-app.de/securityoverview/properties/objectives.html
3. https://twitter.com/patrick_hennig/status/1387738281757061125

## Discoverer

Marcus Mengs
