# CVE-2021-33838

## Description (CNA suggestion)

Luca through 1.7.4 on Android allows remote attackers to obtain sensitive information about COVID-19 tracking because requests related to Check-In State occur shortly after requests for Phone Number Registration.

## Additional Information

Exposure of Sensitive Information Through Data Queries vulnerability in
the Android-Client of culture4life GmbH "Luca" - Covid-19 contact
tracing System allows Luca backend operators (or attackers in control
of the backend) to:

1. Associate an uninfected or traced Guest's Check-Ins to each
   other (conflicts with vendor-defined security objective 'O3')
2. Associate uninfected Guest's Check-Ins to the Guest phone number
   (conflicts with vendor-defined security objective 'O2')
3. Distinguish data sets of infected and uninfected Guests

Cause of Issues:

1. This is caused by the behavior of the Android client, which
   continuously sends lists of overlapping 'TraceIDs' in intervals down to
   3 seconds (depending on the app state) to poll for the App's
   check-in-state. Those TraceIDs are unique to the Android Client which
   generated them (they pseudonyms, calculated as hashes of globally
   unique user secrets). The fact that those TraceIDs are re-used in
   successive requests which are issued by Android Clients, allows to
   associate those requests to the same device, without utilizing further
   meta-data arriving at the backend. If one of those TraceIDs was used in
   a location checkin, the location data gets associated to the TraceID
   and stored by the backend without encryption. This allows to
   reconstruct full location histories on per device level, even if the
   device is rebooted or changes its public IP address.
2. This is caused
   by the fact, that the Android client sends additional meta-data (device
   manufacturer, device type, device OS version) with each
   backend-request, which, in combination with the device IP address,
   allows to associate "location check-in requests" to an initial
   registration request, in which the plain user's phone number is
   submitted for SMS-TAN Verification. In a normal usage scenario, the
   delay between the "phone number registration request" and the
   aforementioned "poll for check-in state requests" is less than one
   minute, which makes it easy to connect per-device location history to
   the device's phone number (PII).
3. If an authorized health department
   requests the location history of an infected guest from the backend,
   the backend learns about the hashes of the infection related TraceIDs.
   As the backend is able to reconstruct sets of TraceIDs belonging to a
   single user/Android Device, the same hashes could be calculated for
   these TraceID-sets. Ultimately those sets could be associated to
   infections traced by health departments.

The issues have been summarized and published in a report and have been
further explained in a video series (German). The vendor was made aware
of this. The report was also included in a press statement of German
"Chaos Computer Club".

## VulnerabilityType: Other

CWE-202: Exposure of Sensitive Information Through Data Queries

## Vendor of Product

culture4life GmbH

## Affected Product Code Base

"Luca" - Covid-19 contact tracing system

- version 1.7.4 and prior versions on Android
- version 1.1.14 and prior versions on Web Backend

## Affected Component

Backend, Android App

## Attack Type

Local

## CVE Impact Other

Backend operators or threat actors with backend access are able to learn location histories and PII of users of the system, which should only be possible for authorized health departments (as defined by vendor security objectives)

## Reference

1. https://github.com/mame82/misc/blob/master/luca_traceIds.md
2. https://luca-app.de/securityoverview/properties/objectives.html
3. https://www.youtube.com/playlist?list=PLKuX6iczGb3kuDsm2RFgbmRkTugkR9-UE
4. https://www.ccc.de/de/updates/2021/luca-app-ccc-fordert-bundesnotbremse

## Discoverer

Marcus Mengs
